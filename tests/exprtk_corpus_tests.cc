#include <gtest/gtest.h>

#include <cmath>
#include <string>
#include <vector>

#include "spice_expr/spice_expr.h"

using namespace spice_expr;

// Auto-generated from ExprTK test files
// Syntax adaptations:
// - x^y -> x**y (power operator)
// - and/or -> &&/||
// - if(c,t,f) -> (c)?(t):(f)
// - <> -> !=
// - Tests using ExprTK-specific features are omitted

struct TestExpr {
  std::string expr;
  double expected;
};

class ExprtkCorpusTest : public ::testing::TestWithParam<TestExpr> {
 protected:
  ExprArena arena;
  SymbolTable symbols;
  FunctionRegistry functions;
  NullCircuitInterface circuit;

  double evaluate(const std::string& expr_str) {
    ExprNode* expr = parse_expression(expr_str, arena);
    RealEvaluator eval(symbols, functions, circuit);
    return eval.evaluate(*expr);
  }
};

TEST_P(ExprtkCorpusTest, EvaluatesCorrectly) {
  const auto& test = GetParam();
  double result = evaluate(test.expr);
  if (std::abs(test.expected) < 1e-10) {
    EXPECT_NEAR(result, test.expected, 1e-10) << "Expr: " << test.expr;
  } else {
    EXPECT_NEAR(result, test.expected, std::abs(test.expected) * 1e-10) << "Expr: " << test.expr;
  }
}

static const std::vector<TestExpr> corpus_tests_0 = {
    {"0", 0.0},
    {"1", 1.0},
    {"2", 2.0},
    {"3", 3.0},
    {"4", 4.0},
    {"5", 5.0},
    {"6", 6.0},
    {"7", 7.0},
    {"8", 8.0},
    {"9", 9.0},
    {"12.12", 12.12},
    {"123.123", 123.123},
    {"1234.1234", 1234.1234},
    {"12345.12345", 12345.12345},
    {"123456.123456", 123456.123456},
    {"0.0", 0.0},
    {"1.0", 1.0},
    {"2.0", 2.0},
    {"3.0", 3.0},
    {"4.0", 4.0},
    {"5.0", 5.0},
    {"6.0", 6.0},
    {"7.0", 7.0},
    {"8.0", 8.0},
    {"9.0", 9.0},
    {"0.0", 0.0},
    {"1.1", 1.1},
    {"2.2", 2.2},
    {"3.3", 3.3},
    {"4.4", 4.4},
    {"5.5", 5.5},
    {"6.6", 6.6},
    {"7.7", 7.7},
    {"8.8", 8.8},
    {"9.9", 9.9},
    {"+0", 0.0},
    {"+1", 1.0},
    {"+2", 2.0},
    {"+3", 3.0},
    {"+4", 4.0},
    {"+5", 5.0},
    {"+6", 6.0},
    {"+7", 7.0},
    {"+8", 8.0},
    {"+9", 9.0},
    {"+0.0", 0.0},
    {"+1.0", 1.0},
    {"+2.0", 2.0},
    {"+3.0", 3.0},
    {"+4.0", 4.0},
    {"+5.0", 5.0},
    {"+6.0", 6.0},
    {"+7.0", 7.0},
    {"+8.0", 8.0},
    {"+9.0", 9.0},
    {"+0.0", 0.0},
    {"+1.1", 1.1},
    {"+2.2", 2.2},
    {"+3.3", 3.3},
    {"+4.4", 4.4},
    {"+5.5", 5.5},
    {"+6.6", 6.6},
    {"+7.7", 7.7},
    {"+8.8", 8.8},
    {"+9.9", 9.9},
    {"-0", 0.0},
    {"-1", -1.0},
    {"-2", -2.0},
    {"-3", -3.0},
    {"-4", -4.0},
    {"-5", -5.0},
    {"-6", -6.0},
    {"-7", -7.0},
    {"-8", -8.0},
    {"-9", -9.0},
    {"-0.0", 0.0},
    {"-1.0", -1.0},
    {"-2.0", -2.0},
    {"-3.0", -3.0},
    {"-4.0", -4.0},
    {"-5.0", -5.0},
    {"-6.0", -6.0},
    {"-7.0", -7.0},
    {"-8.0", -8.0},
    {"-9.0", -9.0},
    {"-0.0", 0.0},
    {"-1.1", -1.1},
    {"-2.2", -2.2},
    {"-3.3", -3.3},
    {"-4.4", -4.4},
    {"-5.5", -5.5},
    {"-6.6", -6.6},
    {"-7.7", -7.7},
    {"-8.8", -8.8},
    {"-9.9", -9.9},
    {"0.0e+0", 0.0},
    {"1.1e+1", 11.0},
    {"2.2e+2", 220.0},
    {"3.3e+3", 3300.0},
    {"4.4e+4", 44000.0},
    {"5.5e+5", 550000.0},
    {"6.6e+6", 6600000.0},
    {"7.7e+7", 77000000.0},
    {"8.8e+8", 880000000.0},
    {"9.9e+9", 9900000000.0},
    {"-0.0e+0", 0.0},
    {"-1.1e+1", -11.0},
    {"-2.2e+2", -220.0},
    {"-3.3e+3", -3300.0},
    {"-4.4e+4", -44000.0},
    {"-5.5e+5", -550000.0},
    {"-6.6e+6", -6600000.0},
    {"-7.7e+7", -77000000.0},
    {"-8.8e+8", -880000000.0},
    {"-9.9e+9", -9900000000.0},
    {"0.0E+0", 0.0},
    {"1.1E+1", 11.0},
    {"2.2E+2", 220.0},
    {"3.3E+3", 3300.0},
    {"4.4E+4", 44000.0},
    {"5.5E+5", 550000.0},
    {"6.6E+6", 6600000.0},
    {"7.7E+7", 77000000.0},
    {"8.8E+8", 880000000.0},
    {"9.9E+9", 9900000000.0},
    {"-0.0E+0", 0.0},
    {"-1.1E+1", -11.0},
    {"-2.2E+2", -220.0},
    {"-3.3E+3", -3300.0},
    {"-4.4E+4", -44000.0},
    {"-5.5E+5", -550000.0},
    {"-6.6E+6", -6600000.0},
    {"-7.7E+7", -77000000.0},
    {"-8.8E+8", -880000000.0},
    {"-9.9E+9", -9900000000.0},
    {"(0)", 0.0},
    {"(1)", 1.0},
    {"(2)", 2.0},
    {"(3)", 3.0},
    {"(4)", 4.0},
    {"(5)", 5.0},
    {"(6)", 6.0},
    {"(7)", 7.0},
    {"(8)", 8.0},
    {"(9)", 9.0},
    {"(0.0)", 0.0},
    {"(1.0)", 1.0},
    {"(2.0)", 2.0},
    {"(3.0)", 3.0},
    {"(4.0)", 4.0},
    {"(5.0)", 5.0},
    {"(6.0)", 6.0},
    {"(7.0)", 7.0},
    {"(8.0)", 8.0},
    {"(9.0)", 9.0},
    {"(0.0)", 0.0},
    {"(1.1)", 1.1},
    {"(2.2)", 2.2},
    {"(3.3)", 3.3},
    {"(4.4)", 4.4},
    {"(5.5)", 5.5},
    {"(6.6)", 6.6},
    {"(7.7)", 7.7},
    {"(8.8)", 8.8},
    {"(9.9)", 9.9},
    {"(+0)", 0.0},
    {"(+1)", 1.0},
    {"(+2)", 2.0},
    {"(+3)", 3.0},
    {"(+4)", 4.0},
    {"(+5)", 5.0},
    {"(+6)", 6.0},
    {"(+7)", 7.0},
    {"(+8)", 8.0},
    {"(+9)", 9.0},
    {"(+0.0)", 0.0},
    {"(+1.0)", 1.0},
    {"(+2.0)", 2.0},
    {"(+3.0)", 3.0},
    {"(+4.0)", 4.0},
    {"(+5.0)", 5.0},
    {"(+6.0)", 6.0},
    {"(+7.0)", 7.0},
    {"(+8.0)", 8.0},
    {"(+9.0)", 9.0},
    {"(+0.0)", 0.0},
    {"(+1.1)", 1.1},
    {"(+2.2)", 2.2},
    {"(+3.3)", 3.3},
    {"(+4.4)", 4.4},
    {"(+5.5)", 5.5},
    {"(+6.6)", 6.6},
    {"(+7.7)", 7.7},
    {"(+8.8)", 8.8},
    {"(+9.9)", 9.9},
    {"(-0)", 0.0},
    {"(-1)", -1.0},
    {"(-2)", -2.0},
    {"(-3)", -3.0},
    {"(-4)", -4.0},
    {"(-5)", -5.0},
    {"(-6)", -6.0},
    {"(-7)", -7.0},
    {"(-8)", -8.0},
    {"(-9)", -9.0},
    {"(-0.0)", 0.0},
    {"(-1.0)", -1.0},
    {"(-2.0)", -2.0},
    {"(-3.0)", -3.0},
    {"(-4.0)", -4.0},
    {"(-5.0)", -5.0},
    {"(-6.0)", -6.0},
    {"(-7.0)", -7.0},
    {"(-8.0)", -8.0},
    {"(-9.0)", -9.0},
    {"(-0.0)", 0.0},
    {"(-1.1)", -1.1},
    {"(-2.2)", -2.2},
    {"(-3.3)", -3.3},
    {"(-4.4)", -4.4},
    {"(-5.5)", -5.5},
    {"(-6.6)", -6.6},
    {"(-7.7)", -7.7},
    {"(-8.8)", -8.8},
    {"(-9.9)", -9.9},
    {"-(1.1)", -1.1},
    {"-(1.1+2.2)", -3.3},
    {"1234567890", 1234567890.0},
    {"123456789.0", 123456789.0},
    {"+1234567890", 1234567890.0},
    {"+123456789.0", 123456789.0},
    {"-1234567890", -1234567890.0},
    {"-123456789.0", -123456789.0},
    {"1234.567890", 1234.56789},
    {"-1234.567890", -1234.56789},
    {"0+9", 9.0},
    {"1+8", 9.0},
    {"2+7", 9.0},
    {"3+6", 9.0},
    {"4+5", 9.0},
    {"5+4", 9.0},
    {"6+3", 9.0},
    {"7+2", 9.0},
    {"8+1", 9.0},
    {"9+0", 9.0},
    {" 0 + 9 ", 9.0},
    {" 1 + 8 ", 9.0},
    {" 2 + 7 ", 9.0},
    {" 3 + 6 ", 9.0},
    {" 4 + 5 ", 9.0},
    {" 5 + 4 ", 9.0},
    {" 6 + 3 ", 9.0},
    {" 7 + 2 ", 9.0},
    {" 8 + 1 ", 9.0},
    {" 9 + 0 ", 9.0},
    {"( 0 + 9 )", 9.0},
    {"( 1 + 8 )", 9.0},
    {"( 2 + 7 )", 9.0},
    {"( 3 + 6 )", 9.0},
    {"( 4 + 5 )", 9.0},
    {"( 5 + 4 )", 9.0},
    {"( 6 + 3 )", 9.0},
    {"( 7 + 2 )", 9.0},
    {"( 8 + 1 )", 9.0},
    {"( 9 + 0 )", 9.0},
    {"1E1+1", 11.0},
    {"1e1+1", 11.0},
    {"1E1-1", 9.0},
    {"1e1-1", 9.0},
    {"1E01+1", 11.0},
    {"1e01+1", 11.0},
    {"1E01-1", 9.0},
    {"1e01-1", 9.0},
    {"1+2", 3.0},
    {"1-2", -1.0},
    {"1*2", 2.0},
    {"1/2", 0.5},
    {"1.1+2.2", 3.3},
    {"1.1-2.2", -1.1},
    {"1.1*2.2", 2.42},
    {"1.1/2.2", 0.5},
    {"0-9", -9.0},
    {"1-8", -7.0},
    {"2-7", -5.0},
    {"3-6", -3.0},
    {"4-5", -1.0},
    {"5-4", 1.0},
    {"6-3", 3.0},
    {"7-2", 5.0},
    {"8-1", 7.0},
    {"9-0", 9.0},
    {" 0 - 9 ", -9.0},
    {" 1 - 8 ", -7.0},
    {" 2 - 7 ", -5.0},
    {" 3 - 6 ", -3.0},
    {" 4 - 5 ", -1.0},
    {" 5 - 4 ", 1.0},
    {" 6 - 3 ", 3.0},
    {" 7 - 2 ", 5.0},
    {" 8 - 1 ", 7.0},
    {" 9 - 0 ", 9.0},
    {"( 0 - 9 )", -9.0},
    {"( 1 - 8 )", -7.0},
    {"( 2 - 7 )", -5.0},
    {"( 3 - 6 )", -3.0},
    {"( 4 - 5 )", -1.0},
    {"( 5 - 4 )", 1.0},
    {"( 6 - 3 )", 3.0},
    {"( 7 - 2 )", 5.0},
    {"( 8 - 1 )", 7.0},
    {"( 9 - 0 )", 9.0},
    {"1 - -1", 2.0},
    {"1 --1", 2.0},
    {"1-- 1", 2.0},
    {"1--1", 2.0},
    {"1 -- -1", 0.0},
    {"1 + -1", 0.0},
    {"1 +-1", 0.0},
    {"1+- 1", 0.0},
    {"1+-1", 0.0},
    {"1 +- -1", 2.0},
    {"1 + +1", 2.0},
    {"1 ++1", 2.0},
    {"1 - -1 + 1", 3.0},
    {"1 --1 + 1", 3.0},
    {"1-- 1 + 1", 3.0},
    {"1--1 + 1", 3.0},
    {"1 -- -1 + 1", 1.0},
    {"1 + -1 + 1", 1.0},
    {"1 +-1 + 1", 1.0},
    {"1+- 1 + 1", 1.0},
    {"1+-1 + 1", 1.0},
    {"1 +- -1 + 1", 3.0},
    {"1 + +1 + 1", 3.0},
    {"1 ++1 + 1", 3.0},
    {"1 - -1 - 1", 1.0},
    {"1 --1 - 1", 1.0},
    {"1-- 1 - 1", 1.0},
    {"1--1 - 1", 1.0},
    {"1 -- -1 - 1", -1.0},
    {"1 + -1 - 1", -1.0},
    {"1 +-1 - 1", -1.0},
    {"1+- 1 - 1", -1.0},
    {"1+-1 - 1", -1.0},
    {"1 +- -1 - 1", 1.0},
    {"1 + +1 - 1", 1.0},
    {"1 ++1 - 1", 1.0},
    {"-(1+2)", -3.0},
    {"+(1+2)", 3.0},
    {"+(1-2)", -1.0},
    {"-(1-2)", 1.0},
    {"(-3*-6)", 18.0},
    {"(-6*-3)", 18.0},
    {"-(-3*-6)", -18.0},
    {"-(-6*-3)", -18.0},
    {"1.1+2.2+3.3", 6.6},
    {"+1.1+2.2+3.3", 6.6},
    {"-1.1-2.2-3.3", -6.6},
    {"1.1*2.2*3.3", 7.986},
    {"+1.1*2.2*3.3", 7.986},
    {"-1.1*-2.2*-3.3", -7.986},
    {"1 + 1/2", 1.5},
    {"1 + (1/2)", 1.5},
    {"1.1 + 1.1/2.2", 1.6},
    {"1.1 + (1.1/2.2)", 1.6},
    {"2 * 1/2", 1.0},
    {"2 * (1/2)", 1.0},
    {"2.2 * 1.1/2.2", 1.1},
    {"2.2 * (1.1/2.2)", 1.1},
    {"1**2", 1.0},
    {"2**1", 2.0},
    {"2**3", 8.0},
    {"(-2)**3", -8.0},
    {"(-2)**4", 16.0},
    {"3**2**4", 43046721.0},
    {"1.1**2.2", 1.2332863005546626},
    {"2.2**1.1", 2.380482257600354},
    {"2.2**3.3", 13.489468760533384},
    {"3.3**2.2**1.1", 17.151939423713763},
    {"+3.3**2.2**1.1", 17.151939423713763},
    {"3.3**+2.2**1.1", 17.151939423713763},
    {"3.3**2.2**+1.1", 17.151939423713763},
    {"3.3**2.2**-1.1", 1.6512729379386797},
    {"+3.3**+2.2**-1.1", 1.6512729379386797},
    {"1.1**(1.1 * 2.2)", 1.2594191657629907},
    {"2.2**(1.1 * 3.3)", 17.498238489535346},
    {"3.3**(1.1 * 2.2)", 17.98058156638875},
    {"1.1**-2.2/1.1", 0.7371288472774338},
    {"1.1**+2.2/1.1", 1.1211693641406022},
    {"1.1**2.2/+1.1", 1.1211693641406022},
    {"1.1**+2.2/+1.1", 1.1211693641406022},
    {"1.1**+2.2/-1.1", -1.1211693641406022},
    {"1.1**2.2/-1.1", -1.1211693641406022},
    {"1.1**+2.2/-1.1", -1.1211693641406022},
    {"+1.1**-2.2/1.1", 0.7371288472774338},
    {"+1.1**+2.2/1.1", 1.1211693641406022},
    {"+1.1**2.2/+1.1", 1.1211693641406022},
    {"+1.1**+2.2/+1.1", 1.1211693641406022},
    {"+1.1**+2.2/-1.1", -1.1211693641406022},
    {"+1.1**2.2/-1.1", -1.1211693641406022},
    {"+1.1**+2.2/-1.1", -1.1211693641406022},
    {"1 <  2", 1.0},
    {"1 <= 2", 1.0},
    {"1.1 <= 2.2", 1.0},
    {"(1.0 + 0.1) <= (2.0 + 0.2)", 1.0},
    {"1 >  2", 0.0},
    {"1 >= 2", 0.0},
    {"1.1 >= 2.2", 0.0},
    {"(1.0 + 0.1) >= (2.0 + 0.2)", 0.0},
    {"1 != 2", 1.0},
    {"1 != 2", 1.0},
    {"1.1 != 2.2", 1.0},
    {"1.1 != 2.2", 1.0},
    {"(1.0 + 0.1) != (2.0 + 0.2)", 1.0},
    {"(1.0 + 0.1) != (2.0 + 0.2)", 1.0},
    {"1 == 1", 1.0},
    {"1.1 == 1.1", 1.0},
    {"1 == 1", 1.0},
    {"1.1 == 1.1", 1.0},
    {"1 != 1", 0.0},
    {"1 != 1", 0.0},
    {"1.1 != 1.1", 0.0},
    {"1.1 != 1.1", 0.0},
    {"(1.0 + 0.1) != (1.0 + 0.1)", 0.0},
    {"(1.0 + 0.1) != (1.0 + 0.1)", 0.0},
    {"1 && 1", 1.0},
    {"1 && 0", 0.0},
    {"0 && 1", 0.0},
    {"0 && 0", 0.0},
    {"1.0 && 1.0", 1.0},
    {"1.0 && 0.0", 0.0},
    {"0.0 && 1.0", 0.0},
    {"0.0 && 0.0", 0.0},
    {"(1 && 1)", 1.0},
    {"(1 && 0)", 0.0},
    {"(0 && 1)", 0.0},
    {"(0 && 0)", 0.0},
    {"(1.0 && 1.0)", 1.0},
    {"(1.0 && 0.0)", 0.0},
    {"(0.0 && 1.0)", 0.0},
    {"(0.0 && 0.0)", 0.0},
    {"1 || 1", 1.0},
    {"1 || 0", 1.0},
    {"0 || 1", 1.0},
    {"0 || 0", 0.0},
    {"1.0 || 1.0", 1.0},
    {"1.0 || 0.0", 1.0},
    {"0.0 || 1.0", 1.0},
    {"0.0 || 0.0", 0.0},
    {"(1 || 1)", 1.0},
    {"(1 || 0)", 1.0},
    {"(0 || 1)", 1.0},
    {"(0 || 0)", 0.0},
    {"(1.0 || 1.0)", 1.0},
    {"(1.0 || 0.0)", 1.0},
    {"(0.0 || 1.0)", 1.0},
    {"(0.0 || 0.0)", 0.0},
    {"1 && 1", 1.0},
    {"1 && 0", 0.0},
    {"0 && 1", 0.0},
    {"0 && 0", 0.0},
    {"1.0 && 1.0", 1.0},
    {"1.0 && 0.0", 0.0},
    {"0.0 && 1.0", 0.0},
    {"0.0 && 0.0", 0.0},
    {"(1 && 1)", 1.0},
    {"(1 && 0)", 0.0},
    {"(0 && 1)", 0.0},
    {"(0 && 0)", 0.0},
    {"(1.0 && 1.0)", 1.0},
    {"(1.0 && 0.0)", 0.0},
    {"(0.0 && 1.0)", 0.0},
    {"(0.0 && 0.0)", 0.0},
    {"1 || 1", 1.0},
    {"1 || 0", 1.0},
    {"0 || 1", 1.0},
    {"0 || 0", 0.0},
    {"1.0 || 1.0", 1.0},
    {"1.0 || 0.0", 1.0},
    {"0.0 || 1.0", 1.0},
    {"0.0 || 0.0", 0.0},
    {"(1 || 1)", 1.0},
    {"(1 || 0)", 1.0},
    {"(0 || 1)", 1.0},
    {"(0 || 0)", 0.0},
    {"(1.0 || 1.0)", 1.0},
    {"(1.0 || 0.0)", 1.0},
    {"(0.0 || 1.0)", 1.0},
    {"(0.0 || 0.0)", 0.0},
    {"abs(1)", 1.0},
    {"abs(-1)", 1.0},
    {"abs(1.0)", 1.0},
    {"abs(-1.0)", 1.0},
    {"min(1,2)", 1.0},
    {"min(1,2,3)", 1.0},
    {"min(1,2,3,4)", 1.0},
    {"min(1,2,3,4,5)", 1.0},
    {"min(1,2,3,4,5,6)", 1.0},
    {"min(1.1,2.2)", 1.1},
    {"min(1.1,2.2,3.3)", 1.1},
};

INSTANTIATE_TEST_SUITE_P(Corpus_0, ExprtkCorpusTest,
                         ::testing::ValuesIn(corpus_tests_0));

static const std::vector<TestExpr> corpus_tests_1 = {
    {"min(1.1,2.2,3.3,4.4)", 1.1},
    {"min(1.1,2.2,3.3,4.4,5.5)", 1.1},
    {"min(1.1,2.2,3.3,4.4,5.5,6.6)", 1.1},
    {"min(min(1,2),min(3,4))", 1.0},
    {"max(1,2)", 2.0},
    {"max(1,2,3)", 3.0},
    {"max(1,2,3,4)", 4.0},
    {"max(1,2,3,4,5)", 5.0},
    {"max(1,2,3,4,5,6)", 6.0},
    {"max(1.1,2.2)", 2.2},
    {"max(1.1,2.2,3.3)", 3.3},
    {"max(1.1,2.2,3.3,4.4)", 4.4},
    {"max(1.1,2.2,3.3,4.4,5.5)", 5.5},
    {"max(1.1,2.2,3.3,4.4,5.5,6.6)", 6.6},
    {"max(max(1,2),max(3,4))", 4.0},
    {"floor(1.0)", 1.0},
    {"floor(1.1)", 1.0},
    {"floor(-1.0)", -1.0},
    {"floor(-1.1)", -2.0},
    {"ceil(1.0)", 1.0},
    {"ceil(1.1)", 2.0},
    {"ceil(-1.0)", -1.0},
    {"ceil(-1.1)", -1.0},
    {"round(1.1)", 1.0},
    {"round(1.49)", 1.0},
    {"round(1.5)", 2.0},
    {"round(1.9)", 2.0},
    {"cos(0.0)", 1.0},
    {"sin(0.0)", 0.0},
    {"exp(1.0)", 2.718281828459045},
    {"exp(0.0)", 1.0},
    {"log(2.7182818284590451)", 1.0},
    {"hypot(3.0,4.0)", 5.0},
    {"hypot(1.0,sqrt(3.0))", 2.0},
    {"(1 < 2)?(3):(4)", 3.0},
    {"(1.1 < 2.2)?(3.3):(4.4)", 3.3},
    {"((1.0+1.1) < (2.0+1.2))?(3.3):(4.4)", 3.3},
    {"(1 == 2)?(3):(4)", 4.0},
    {"(1.1 == 2.2)?(3.3):(4.4)", 4.4},
    {"((1.0+1.1) == (2.0+1.2))?(3.3):(4.4)", 4.4},
    {"(1 == 2)?(3):(4)", 4.0},
    {"(1.1 == 2.2)?(3.3):(4.4)", 4.4},
    {"((1.0+1.1) == (2.0+1.2))?(3.3):(4.4)", 4.4},
    {"(1 >= 2)?(3):(4)", 4.0},
    {"(1.1 >= 2.2)?(3.3):(4.4)", 4.4},
    {"((1.0+1.1) >= (2.0+1.2))?(3.3):(4.4)", 4.4},
    {"(((1.0 + 2.0) == 3.0) && ((4.0 + 5.0) < 9.0))?(1):(2)", 2.0},
    {"(3.0 - 1.0 - 2.0) == ((3.0 - 1.0) - 2.0)", 1.0},
    {"sgn( 0)", 0.0},
    {"sgn(+3)", 1.0},
    {"sgn(-3)", -1.0},
    {"1+2+3+4+5+6+7+8+9+0", 45.0},
    {"1 + 2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 0", 45.0},
    {"1.0 + 2.0 + 3.0 + 4.0 + 5.0 + 6.0 + 7.0 + 8.0 + 9.0 + 0.0", 45.0},
    {"(1+2)+(3+4)+(5+6)+(7+8)+(9+0)", 45.0},
    {"(1-2)+(3-4)+(5-6)+(7-8)+(9-0)", 5.0},
    {"(1+2)-(3+4)-(5+6)-(7+8)-(9+0)", -39.0},
    {"(1.0+2.0)+(3.0+4.0)+(5.0+6.0)+(7.0+8.0)+(9.0+0.0)", 45.0},
    {"(1.0-2.0)+(3.0-4.0)+(5.0-6.0)+(7.0-8.0)+(9.0-0.0)", 5.0},
    {"(1.0+2.0)-(3.0+4.0)-(5.0+6.0)-(7.0+8.0)-(9.0+0.0)", -39.0},
    {"1+2-3*4/5+6-7*8/9+0", 0.37777777777777777},
    {"1.1+2.2-3.3*4.4/5.5+6.6-7.7*8.8/9.9+0.0", 0.41555555555555557},
    {"(1+2)-(3*4)/(5+6)-(7*8)/(9+0)", -4.313131313131313},
    {"1/1+1/2+1/3+1/4+1/5+1/6+1/7+1/8+1/9", 2.828968253968254},
    {"(1/1)+(1/2)+(1/3)+(1/4)+(1/5)+(1/6)+(1/7)+(1/8)+(1/9)", 2.828968253968254},
    {"1.0/1.0+1.0/2.0+1.0/3.0+1.0/4.0+1.0/5.0+1.0/6.0+1.0/7.0+1.0/8.0+1.0/9", 2.828968253968254},
    {"(1.0/1.0)+(1.0/2.0)+(1.0/3.0)+(1.0/4.0)+(1.0/5.0)+(1.0/6.0)+(1.0/7.0)+(1.0/8.0)+(1.0/9)", 2.828968253968254},
    {"1/1*1/2*1/3*1/4*1/5*1/6*1/7*1/8*1/9", 2.75573192239859e-06},
    {"(1/1)*(1/2)*(1/3)*(1/4)*(1/5)*(1/6)*(1/7)*(1/8)*(1/9)", 2.75573192239859e-06},
    {"1.0/1.0*1.0/2.0*1.0/3.0*1.0/4.0*1.0/5.0*1.0/6.0*1.0/7.0*1.0/8.0*1.0/9", 2.75573192239859e-06},
    {"(1.0/1.0)*(1.0/2.0)*(1.0/3.0)*(1.0/4.0)*(1.0/5.0)*(1.0/6.0)*(1.0/7.0)*(1.0/8.0)*(1.0/9)", 2.75573192239859e-06},
    {" 0 ? 1 : 2", 2.0},
    {" 1 ? 3 : 4", 3.0},
    {"(0 ? 1 : 2) == 2", 1.0},
    {"(1 ? 3 : 4) == 3", 1.0},
    {"(1 < 2 ? 3 : 4) == 3", 1.0},
    {"(1 > 2 ? 3 : 4) == 4", 1.0},
    {"(1 < 2 ? 3 + 5 : 4) == 8", 1.0},
    {"(1 > 2 ? 3 : 4 + 5) == 9", 1.0},
    {"(2 < 3 + 3 ? 7 : 9) == 7", 1.0},
    {"(1 + 1 < 3 ? 7 : 9) == 7", 1.0},
    {"(1 + 1 < 3 + 3 ? 7 : 9) == 7", 1.0},
    {"(2 > 3 + 3 ? 7 : 9) == 9", 1.0},
    {"(1 + 1 > 3 ? 7 : 9) == 9", 1.0},
    {"(1 + 1 > 3 + 3 ? 7 : 9) == 9", 1.0},
    {"(2 < (3 + 3) ? 7 : 9) == 7", 1.0},
    {"((1 + 1) < 3 ? 7 : 9) == 7", 1.0},
    {"((1 + 1) < (3 + 3) ? 7 : 9) == 7", 1.0},
    {"(min(1,2) ? 1 + 3 : 1 + 4) == 4", 1.0},
    {"(min(0,1) ? 1 + 3 : 1 + 4) == 5", 1.0},
    {" 1.175494350822287508e-38", 1.1754943508222875e-38},
    {" 3.402823466385288598e+38", 3.4028234663852886e+38},
    {"+1.175494350822287508e-38", 1.1754943508222875e-38},
    {"+3.402823466385288598e+38", 3.4028234663852886e+38},
    {"-1.175494350822287508e-38", -1.1754943508222875e-38},
    {"-3.402823466385288598e+38", -3.4028234663852886e+38},
    {" 2.2250738585072013831e-308", 2.2250738585072014e-308},
    {" 1.7976931348623157081e+308", 1.7976931348623157e+308},
    {"+2.2250738585072013831e-308", 2.2250738585072014e-308},
    {"+1.7976931348623157081e+308", 1.7976931348623157e+308},
    {"-2.2250738585072013831e-308", -2.2250738585072014e-308},
    {"-1.7976931348623157081e+308", -1.7976931348623157e+308},
};

INSTANTIATE_TEST_SUITE_P(Corpus_1, ExprtkCorpusTest,
                         ::testing::ValuesIn(corpus_tests_1));
